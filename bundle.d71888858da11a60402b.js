(()=>{"use strict";var n={56(n,t,e){n.exports=function(n){var t=e.nc;t&&n.setAttribute("nonce",t)}},72(n){var t=[];function e(n){for(var e=-1,a=0;a<t.length;a++)if(t[a].identifier===n){e=a;break}return e}function a(n,a){for(var i={},r=[],s=0;s<n.length;s++){var c=n[s],d=a.base?c[0]+a.base:c[0],l=i[d]||0,u="".concat(d," ").concat(l);i[d]=l+1;var p=e(u),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var f=o(m,a);a.byIndex=s,t.splice(s,0,{identifier:u,updater:f,references:1})}r.push(u)}return r}function o(n,t){var e=t.domAPI(t);return e.update(n),function(t){if(t){if(t.css===n.css&&t.media===n.media&&t.sourceMap===n.sourceMap&&t.supports===n.supports&&t.layer===n.layer)return;e.update(n=t)}else e.remove()}}n.exports=function(n,o){var i=a(n=n||[],o=o||{});return function(n){n=n||[];for(var r=0;r<i.length;r++){var s=e(i[r]);t[s].references--}for(var c=a(n,o),d=0;d<i.length;d++){var l=e(i[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},113(n){n.exports=function(n,t){if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},314(n){n.exports=function(n){var t=[];return t.toString=function(){return this.map(function(t){var e="",a=void 0!==t[5];return t[4]&&(e+="@supports (".concat(t[4],") {")),t[2]&&(e+="@media ".concat(t[2]," {")),a&&(e+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),e+=n(t),a&&(e+="}"),t[2]&&(e+="}"),t[4]&&(e+="}"),e}).join("")},t.i=function(n,e,a,o,i){"string"==typeof n&&(n=[[null,n,void 0]]);var r={};if(a)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(r[c]=!0)}for(var d=0;d<n.length;d++){var l=[].concat(n[d]);a&&r[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),e&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=e):l[2]=e),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},365(n,t,e){e.d(t,{A:()=>s});var a=e(601),o=e.n(a),i=e(314),r=e.n(i)()(o());r.push([n.id,'* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n  background-color: #f5f7fa;\n  padding: 20px;\n}\n\nheader {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n}\n\nh1 {\n  color: #2c3e50;\n}\n\nbutton {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n#add-ticket-btn {\n  background-color: #27ae60;\n  color: white;\n}\n\n#add-ticket-btn:hover {\n  background-color: #219653;\n}\n\n#loading {\n  text-align: center;\n  padding: 20px;\n}\n\n.hidden {\n  display: none !important;\n}\n\n.ticket {\n  background: white;\n  border-radius: 8px;\n  padding: 16px;\n  margin-bottom: 12px;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);\n  position: relative;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n\n.ticket:hover {\n  background: #f9fbfd;\n}\n\n.ticket.done .ticket-name {\n  text-decoration: line-through;\n  color: #7f8c8d;\n}\n\n.ticket-name {\n  font-weight: bold;\n  margin-bottom: 4px;\n  word-break: break-word;\n}\n\n.ticket-meta {\n  font-size: 12px;\n  color: #95a5a6;\n  margin-bottom: 8px;\n}\n\n.ticket-actions {\n  position: absolute;\n  top: 12px;\n  right: 12px;\n  display: flex;\n  gap: 6px;\n}\n\n.ticket-actions button {\n  width: 28px;\n  height: 28px;\n  font-size: 14px;\n  padding: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.ticket-actions .edit {\n  background: #3498db;\n  color: white;\n}\n\n.ticket-actions .delete {\n  background: #e74c3c;\n  color: white;\n}\n\n.ticket-actions .toggle {\n  background: #95a5a6;\n  color: white;\n}\n\n/* Modal */\n.modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: white;\n  padding: 24px;\n  border-radius: 8px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n}\n\n.modal h2 {\n  margin-bottom: 16px;\n  color: #2c3e50;\n}\n\n.modal-message {\n  display: block;\n  margin: 8px 0 20px;\n  font-weight: bold;\n  color: #34495e;\n}\n\n.modal input,\n.modal textarea {\n  width: 100%;\n  padding: 10px;\n  margin-bottom: 16px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-family: inherit;\n}\n\n.modal textarea {\n  min-height: 80px;\n  resize: vertical;\n}\n\n.modal-buttons {\n  display: flex;\n  justify-content: flex-end;\n  gap: 10px;\n}\n\n.modal-buttons button {\n  padding: 8px 16px;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\n.modal-buttons .cancel {\n  background: #95a5a6;\n  color: white;\n}\n\n.modal-buttons .submit {\n  background: #27ae60;\n  color: white;\n}\n\n.modal-buttons .delete {\n  background: #e74c3c;\n}\n\n.ticket-header {\n  cursor: pointer;\n  padding: 16px;\n  margin: -16px -16px 0;\n  border-radius: 8px 8px 0 0;\n}\n\n.ticket-header:hover {\n  background-color: #f8f9fa;\n}\n\n.ticket-details {\n  padding: 0 16px 16px;\n  border-top: 1px solid #eee;\n  margin-top: 8px;\n}\n\n.ticket-details.hidden {\n  display: none;\n}\n\n/* Аккуратная анимация */\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n.ticket-details:not(.hidden) {\n  animation: slideDown 0.2s ease;\n}\n',""]);const s=r},540(n){n.exports=function(n){var t=document.createElement("style");return n.setAttributes(t,n.attributes),n.insert(t,n.options),t}},601(n){n.exports=function(n){return n[1]}},659(n){var t={};n.exports=function(n,e){var a=function(n){if(void 0===t[n]){var e=document.querySelector(n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(n){e=null}t[n]=e}return t[n]}(n);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}},825(n){n.exports=function(n){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=n.insertStyleElement(n);return{update:function(e){!function(n,t,e){var a="";e.supports&&(a+="@supports (".concat(e.supports,") {")),e.media&&(a+="@media ".concat(e.media," {"));var o=void 0!==e.layer;o&&(a+="@layer".concat(e.layer.length>0?" ".concat(e.layer):""," {")),a+=e.css,o&&(a+="}"),e.media&&(a+="}"),e.supports&&(a+="}");var i=e.sourceMap;i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(a,n,t.options)}(t,n,e)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(t)}}}}},t={};function e(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={id:a,exports:{}};return n[a](i,i.exports,e),i.exports}e.n=n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},e.d=(n,t)=>{for(var a in t)e.o(t,a)&&!e.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:t[a]})},e.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t),e.nc=void 0;var a=e(72),o=e.n(a),i=e(825),r=e.n(i),s=e(659),c=e.n(s),d=e(56),l=e.n(d),u=e(540),p=e.n(u),m=e(113),f=e.n(m),b=e(365),g={};async function v(n,t={},e=null){const a=new URL("http://localhost:7070");a.searchParams.set("method",n);for(const[n,e]of Object.entries(t))null!=e&&a.searchParams.set(n,e);const o={method:e?"POST":"GET",headers:{"Content-Type":"application/json"}};e&&(o.body=JSON.stringify(e));const i=await fetch(a,o);if(!i.ok)throw new Error(`HTTP ${i.status}: ${await i.text()}`);return 204===i.status?null:await i.json()}g.styleTagTransform=f(),g.setAttributes=l(),g.insert=c().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=p(),o()(b.A,g),b.A&&b.A.locals&&b.A.locals;const x=(n,t)=>v("updateById",{id:n},t);function y({title:n,message:t="",fields:e=[],onSubmit:a,onCancel:o,submitText:i="Сохранить",cancelText:r="Отмена",submitClass:s="submit",danger:c=!1,noForm:d=!1}){const l=document.createElement("div");l.className="modal",l.innerHTML=`\n      <div class="modal-content">\n        <h2>${n}</h2>\n  \n        ${t?`<p class="modal-message">${t}</p>`:""}\n  \n        ${d?`\n          <div class="modal-buttons">\n            <button type="button" class="cancel">${r}</button>\n            <button type="button" class="${s} ${c?"delete":""}">\n              ${i}\n            </button>\n          </div>\n        `:`\n          <form>\n            ${e.map(n=>`\n              <label for="${n.name}">${n.label}</label>\n              ${"textarea"===n.type?`<textarea id="${n.name}" name="${n.name}" ${!1!==n.required?"required":""}>${n.value||""}</textarea>`:`<input type="${n.type||"text"}" id="${n.name}" name="${n.name}" value="${n.value||""}" ${!1!==n.required?"required":""}>`}\n            `).join("")}\n  \n            <div class="modal-buttons">\n              <button type="button" class="cancel">${r}</button>\n              <button type="submit" class="${s} ${c?"delete":""}">${i}</button>\n            </div>\n          </form>\n        `}\n      </div>\n    `,document.body.appendChild(l);const u=l.querySelector(".cancel"),p=l.querySelector(`.${s}`);if(u.addEventListener("click",()=>{o?.(),l.remove()}),d)p.addEventListener("click",async()=>{await(a?.()),l.remove()});else{const n=l.querySelector("form");n.addEventListener("submit",async t=>{t.preventDefault();const e=Object.fromEntries(new FormData(n).entries());await(a?.(e)),l.remove()})}return l}function h(n=!0){document.getElementById("loading").classList.toggle("hidden",!n)}async function k(){try{h(!0),n=await v("allTickets"),document.getElementById("tickets-list").innerHTML=n.map(n=>`\n        <div class="ticket ${n.status?"done":""}" data-id="${n.id}">\n          <div class="ticket-header" data-action="toggle-details">\n            <div class="ticket-name">${n.name}</div>\n            <div class="ticket-meta">Создано: ${new Date(n.created).toLocaleString()}</div>\n          </div>\n          <div class="ticket-details hidden" data-details>\n            <div class="ticket-description">${n.description?`<strong>Описание:</strong><br>${n.description}`:"<em>Без описания</em>"}</div>\n          </div>\n          <div class="ticket-actions">\n            <button type="button" class="toggle" title="${n.status?"Отменить выполнение":"Отметить как выполненное"}">\n              ${n.status?"✓":"○"}\n            </button>\n            <button type="button" class="edit" title="Редактировать">✎</button>\n            <button type="button" class="delete" title="Удалить">×</button>\n          </div>\n        </div>\n      `).join("")}catch(n){alert("Ошибка загрузки тикетов: "+n.message)}finally{h(!1)}var n}document.addEventListener("DOMContentLoaded",()=>{!function(){const n=document.getElementById("tickets-list");document.getElementById("add-ticket-btn").addEventListener("click",n=>{n.preventDefault(),y({title:"Новый тикет",fields:[{name:"name",label:"Краткое описание",type:"text"},{name:"description",label:"Подробное описание",type:"textarea",required:!1}],onSubmit:async n=>{try{h(!0),await(t=n,v("createTicket",{},t)),await k()}catch(n){alert("Ошибка при создании: "+n.message)}finally{h(!1)}var t},onCancel:()=>{}})}),n.addEventListener("click",async n=>{if(n.preventDefault(),n.target.closest('[data-action="toggle-details"]')){const t=n.target.closest(".ticket");if(!t)return;return void t.querySelector("[data-details]").classList.toggle("hidden")}const t=n.target.closest(".ticket");if(!t)return;const e=t.dataset.id;if(n.target.classList.contains("toggle"))try{const a=t.classList.contains("done");await x(e,{status:!a}),t.classList.toggle("done",!a),n.target.textContent=a?"○":"✓",n.target.title=a?"Отметить как выполненное":"Отменить выполнение"}catch(n){alert("Ошибка обновления статуса: "+n.message)}else if(n.target.classList.contains("edit"))try{const n=await(n=>v("ticketById",{id:n}))(e);y({title:"Редактировать тикет",fields:[{name:"name",label:"Краткое описание",value:n.name},{name:"description",label:"Подробное описание",value:n.description||"",type:"textarea",required:!1}],onSubmit:async n=>{try{h(!0),await x(e,n),await k()}catch(n){alert("Ошибка при обновлении: "+n.message)}finally{h(!1)}},onCancel:()=>{}})}catch(n){alert("Ошибка загрузки для редактирования: "+n.message)}else n.target.classList.contains("delete")&&y({title:"Подтверждение удаления",message:`Вы уверены, что хотите удалить тикет "${t.querySelector(".ticket-name").textContent}"?`,submitText:"Удалить",danger:!0,noForm:!0,onSubmit:async()=>{await(n=>v("deleteById",{id:n}))(e),await k()}})})}(),k()})})();